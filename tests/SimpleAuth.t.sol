// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import {SimpleAuth} from "../contracts/SimpleAuth.sol";

contract SimpleAuthTest is Test {
  bytes16 public constant APP_ID = 0x112a692a2005259c25f6094161007967;

  SimpleAuth public simpleAuth;

  function setUp() public {
    simpleAuth = new SimpleAuth(APP_ID);
  }

  function test_SimpleAuth() public {
    assertEq(simpleAuth.counter(), 0);

    // Data Vault ownership
    // signature of uint256 3
    bytes
      memory response = hex"0000000000000000000000000000000000000000000000000000000000000020112a692a2005259c25f609416100796700000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001143592cf8b23b593accf62ce0d11c5e5aadebc8eeb1a048c334f0502547c9e4100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c0065ecc6b7d6fa3bcefb4caed492189a3526a8516977ec808bbe348ff214643632c25ad67759565f338f1d0e9a157174540ca655571524bec2646a2b13b5e8f6b1ca8deaf56908680653f91efd206da5468e3dafc427f609ccc5e23eec807916207b5f9248a18ee40ee7092413721bfdda47c65d66d1a8007a2dd27bd28fd0ae32b19b0e4139d9b971781552dfa5b5c077c4b8da0014b8f0d4d74e22009e75da20e1e3456b83e31b167c9a46f28bcc7464ae3f7b9e2a7489442cb1a69184620762da03676288162e6ed78541c780d18c7536bfdbcea1d5c3a68e340388981045507d79e3356ce0d8b06c8e0e5d44c066d208d1a4ca27d3ea45cb522e6fb10bd8f000000000000000000000000000000000000000000000000000000000000000000c620431992bb5a1818e1ef290d79b3c8f39838541f408b4e9d3ff4af71f8572ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db74000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000143592cf8b23b593accf62ce0d11c5e5aadebc8eeb1a048c334f0502547c9e410a13966ba7f5bb9e347b50a2b7fa12a296b75b5e901fdee64c14cc69b5645bc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";

    simpleAuth.incrementWithSismoConnect(response, 3);
    assertEq(simpleAuth.counter(), 3);
  }
}
