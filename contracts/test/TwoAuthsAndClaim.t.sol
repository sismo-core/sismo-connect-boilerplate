// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import {TwoAuthsAndClaim} from "../src/TwoAuthsAndClaim.sol";

contract TwoAuthsAndClaimTest is Test {
    bytes16 public constant APP_ID = 0x112a692a2005259c25f6094161007967;
    bytes16 public constant GROUP_ID = 0xe9ed316946d3d98dfcd829a53ec9822e;

    TwoAuthsAndClaim public twoAuthsAndClaim;

    function setUp() public {
        // prank to setup the correct root in the dev staging registry tree
        vm.startPrank(0xa687922C4bf2eB22297FdF89156B49eD3727618b);
        address(0xF3dAc93c85e92cab8f811b3A3cCaCB93140D9304).call(
            abi.encodeWithSignature(
                "registerRoot(uint256)",
                0x11F7FDE533960EA368AB0AF29E6690687BB97FF54AF42F77A071ADF0E5A0EF7B
            )
        );
        vm.stopPrank();

        twoAuthsAndClaim = new TwoAuthsAndClaim(APP_ID, GROUP_ID);
    }

    function test_TwoAuthsAndClaim() public {
        assertEq(twoAuthsAndClaim.counter(), 0);

        // Twitter account ownership (optional)
        // GitHub account ownership (required)
        // group membership of GROUP_ID
        // signature of uint256 3
        bytes
            memory response = hex"0000000000000000000000000000000000000000000000000000000000000020112a692a2005259c25f609416100796700000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000052000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c02643399a007ae4a36efabb7647c9c723c97637aa62b277776779343140a2bdce14e44f48031c709bffc380f32e07fb66c7129ad346352f7fed04ccd264efe55e22d60b67726d2ea5a5fe638be750f924b80fb3cffeeb9fe52cef962720bf1a18051b2ef7296b1b0914b8cdb6b47ae2de71215ded5a760dbc46d8ea66bcddffb81937c50c1dfdff20ea9d3fc8705dff6b82fe648416260e8ef82cb34fbe34195d0ea02fb123dbd9ea8b42d4382a577beecab881cc4b455f4f339caf03cac74bc910582df34c85a4d92f98bc01e6af766fe86a019be63c2172c5d4238cf1ca184b03f24f903f28b822f5e511ec3f1153b15219000b8761fb79683ea7ecbd3effcf000000000000000000000000000000000000000000000000000000000000000000c620431992bb5a1818e1ef290d79b3c8f39838541f408b4e9d3ff4af71f8572ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7411f7fde533960ea368ab0af29e6690687bb97ff54af42f77a071adf0e5a0ef7b21a63725868405196971cad8f2e46ed111118a9869929d0f87c154c9c60d015f124bd705fd7680828b9d00982d08a5baef8249ad2e0dbcce3597a9afb1ad0cb90000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc00000000000000000000000000000000000000000000000000000000000000002d495b4c6618a926b0a741ad2e1ff25ace5558f09c853bac3aa5306aba598bd30a13966ba7f5bb9e347b50a2b7fa12a296b75b5e901fdee64c14cc69b5645bc200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c01954e6fe79de1360f35d24735bde19dfd165eccb3b64ed07277315f02edca22b121db5e5348522f13aaa857a536b2e36c24fe3201574313e7a560fe886b85598217be6d8583c6b7d613e54ab83222101b30313fd1387017a16dd1c65e157ae692797729cb8a8c4f7b9f4a994d4e95e7e6e16d9f368d3e97c58f202feac2947af011ce7bb289057d094d70f36976168a9b1667d26281bc4718ecf385b04e7f2e11319be2e54d6e3e0fdd815c4f0c698f655aadf66d8d8c150c763a82769181d9009b2e79ba314cdecfcd5784c52c276046e43341a9c20782e601b94c3ecabd9872ed57793d75851b2c318804fbf0261d0f5a04970cd34eac5729a140cb2f6b0e3000000000000000000000000100100000000000000000000000000009999037000c620431992bb5a1818e1ef290d79b3c8f39838541f408b4e9d3ff4af71f8572ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d495b4c6618a926b0a741ad2e1ff25ace5558f09c853bac3aa5306aba598bd30a13966ba7f5bb9e347b50a2b7fa12a296b75b5e901fdee64c14cc69b5645bc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000";

        twoAuthsAndClaim.incrementWithSismoConnect(response, 3);
        assertEq(twoAuthsAndClaim.counter(), 3);
    }
}
